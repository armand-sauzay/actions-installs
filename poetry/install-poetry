#/bin/bash

check_install() {
    local tool=$1
    command -v $tool &> /dev/null
    if [ $? -eq 0 ]; then
        echo "$tool found"
        return 0
    else
        echo "$tool not found"
        return 1
    fi
}

install_poetry() {
    echo "installing poetry"
    #if poetry version different from "latest", install that version
    if [ -n "$POETRY_VERSION" ] && [ "$POETRY_VERSION" != "latest" ]; then
        echo "installing poetry version $POETRY_VERSION"
        pip install "poetry==$POETRY_VERSION"
    else
        echo "installing latest poetry version"
        pip install poetry
    fi
}


function main() {
    check_install poetry
    if [ $? -eq 1 ]; then
        echo "poetry not found, installing, with pip"
        check_install pip
        if [ $? -eq 1 ]; then
            echo "pip not found"
            exit 1
        fi
        install_poetry
    fi

}

main
